import sys 
from collections import deque

input = sys.stdin.readline
N = int(input())
heights = [int(input()) for _ in range(N)]
stack = deque()
res = 0

for i in range(N-1,-1,-1) :
    eql = 0
    print('i',i,'heights',heights[i])
    while stack and heights[stack[-1]] <= heights[i] :
        if heights[stack[-1]] == heights[i] :
            eql += 1
        res += 1
        stack.pop()

    if eql :
        res += eql
    elif not eql and stack :
        res += 1

    print(res,'res')

    stack.append(i)
    print(stack,'stack')
print(res)